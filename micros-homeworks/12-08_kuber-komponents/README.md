# Домашнее задание к занятию «Компоненты Kubernetes»

### Задание. Необходимо определить требуемые ресурсы
Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

  1. Необходимо упаковать приложение в чарт для деплоя в разные окружения.
  2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
  3. Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
  4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.
  5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.
___________________________________________________________________________________________________________________________________________________
### Решение
Прежде всего, следует учитывать, что для обеспечения отказоустойчивости минимальное количество нод должно быть 3. Это оптимально как для рабочих нод, так и для контрольных, поэтому потребуется 6 нод, разделив их на рабочие и контрольные.

Расчет требуемых ресурсов:
Суммируя требуемые ресурсы, получаем приблизительно 17 ядер и 31 ГБ оперативной памяти. Для обеспечения отказоустойчивости кэша и базы данных при падении одной ноды необходимо, чтобы каждая рабочая нода могла справиться с перераспределенной нагрузкой. Мы не знаем, как кластер распределит ноды, так как этот процесс автоматизирован. Таким образом, лучше исходить из усредненных значений.

Если в нормальных условиях на одну ноду приходится 17/3 ≈ 6 ядер и 31/3 ≈ 11 ГБ оперативки (округленно с избытком), то при падении одной ноды каждая из оставшихся должна иметь 17/2 ≈ 9 ядер и 31/2 ≈ 16 ГБ оперативки. Также полезно заложить дополнительный запас для пиковых нагрузок, которые могут превышать усредненные значения. Добавим 50% к значениям.

#### Таким образом, каждая рабочая нода должна иметь:
```
14 ядер (9 * 1.5)

24 ГБ оперативки (16 * 1.5)
```
#### Контрольные ноды:
Для контрольных нод рекомендуется:
```
2 ядра

2 ГБ оперативной памяти
```
#### Итоговые ресурсы:
```
3 рабочие ноды по 14 ядер и 24 ГБ оперативки

3 контрольные ноды по 2 ядра и 2 ГБ оперативки
```
Следует отметить, что это минимальные требования. В реальном продуктовом кластере я бы рекомендовал использовать не менее 4 рабочих нод и предусмотреть возможность падения двух или более нод одновременно.

Размер HDD/SSD не ограничен задачей, поэтому выбирается в соответствии с требованиями проекта с дополнительным запасом.
